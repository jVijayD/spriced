<!-- BUSINESS RULE MANAGEMENT COMPONENT -->
<sp-one-col>
<div class="ml-sm-2 pb-6 px-4 businessmanagement">
  <!-- <h2 class="font-medium">Business Rule Management</h2> -->

  <!-- DROPDOWN FIELDS IN GRID LIST -->
  <mat-grid-list cols="4" rowHeight="2:1">
    <form [formGroup]="listForm">
      <div class="mat_dropdown mt-4">
        <mat-form-field appearance="outline">
          <mat-label>Model:</mat-label>
          <mat-select (valueChange)="handleEntityByModels($event, 'modelChange')" [(value)]="defaultModel" formControlName="model">
            <mat-option *ngFor="let model of models" [value]="model.id">
              {{model.displayName}}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field class="ml-4" appearance="outline">
          <mat-label>Entity:</mat-label>
          <mat-select (valueChange)="handleAttributeByEntity($event)" [(value)]="defaultEntity" formControlName="entity">
            <mat-option *ngFor="let entity of entities" [value]="entity.id">
              {{entity.displayName}}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field class="ml-4" appearance="outline">
          <mat-label>Attribute:</mat-label>
          <mat-select [value]="defValue" formControlName="attrubute">
            <mat-option *ngFor="let attribute of attributes" [value]="attribute.id">
              {{attribute.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>

      </div>
    </form>
  </mat-grid-list>

<sp-data-grid
      class="w-full mt-8 block"
      #dataGrid
      title="Rule List"
      [enableRowIndex]="false"
      [isArray]="false"
      [headers]="headers"
      [rows]="rows"
      [rowHeight]="40"
      [headerHeight]="40"
      [footerHeight]="40"
      [columnMode]="columnMode"
      [virtualScroll]="false"
      [selectionType]="selectionType"
      [limit]="10"
      [isExternalPaging]="true"
      [isExternalSorting]="false"
      [sortType]="sortType"
      [count]="totalElements"
      [attributes]="attributes"
      (paginate)="onPaginate($event)"
      (itemSelected)="onItemSelected($event)"
      (updateExcluded)="updateExcluded($event)"
    >
      <ng-container>
        <sp-header-action
          icon="add_box"
          text="Add"
          title="Add Entity"
          [disabled]="!listForm.valid"
          (actionClick)="addNewRule()"
        ></sp-header-action>
  
        <sp-header-action
          icon="sync"
          text="Refresh"
          title="Refresh"
          (actionClick)="onRefresh()"
        ></sp-header-action>
  
        <sp-header-action
          icon="edit"
          text="Edit"
          title="Edit Entity"
          [disabled]="selectedItem == null"
          (actionClick)="editBusinessRule(selectedItem)"
        ></sp-header-action>
  
        <sp-header-action
          icon="delete"
          text="Delete"
          title="Delete Entity"
          [disabled]="selectedItem == null"
          (actionClick)="deleteRule(selectedItem)"
        ></sp-header-action>

        <sp-header-action
        icon="visibility"
        text="View"
        title="View Entity"
        [disabled]="selectedItem == null"
        (actionClick)="editBusinessRule(selectedItem, 'preview')"
      ></sp-header-action>

      </ng-container>
    </sp-data-grid>
    </div>
  </sp-one-col>
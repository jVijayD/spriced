<sp-vbox>
  <sp-hbox>
    <mat-form-field appearance="outline">
      <mat-label>User Role</mat-label>
      <mat-select matNativeControl (selectionChange)="onSelectRole($event)" [(value)]="selectedRole">
          <mat-option>
            <ngx-mat-select-search
              placeholderLabel="Search"
              ngModel
              (ngModelChange)="filterRolesSelection($event)"
            ></ngx-mat-select-search>
          </mat-option>
          <mat-option value="" class="option">--Select--</mat-option>
        <mat-option  matTooltipClass="custom-tooltip" matTooltipDisabled="{{item.name.length < 25}}" matTooltipPosition="right" matTooltip="{{item.name}}" *ngFor="let item of filteredRoleList" [value]="item">{{item.name}}</mat-option>
      </mat-select>
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Model</mat-label>
      <mat-select matNativeControl (selectionChange)="onSelectModel($event)" [(value)]="selectedModel">
        <mat-option>
          <ngx-mat-select-search
            placeholderLabel="Search"
            ngModel
            (ngModelChange)="filterModelsSelection($event)"
          ></ngx-mat-select-search>
        </mat-option>
        <mat-option value="" class="option">--Select--</mat-option>
        <mat-option *ngFor="let item of filteredModelList" [value]="item">{{item.displayName}}</mat-option>
      </mat-select>
    </mat-form-field>
    <button mat-raised-button color="accent" (click)="onClearClick()">
      Clear
    </button>
    <button mat-raised-button color="primary" (click)="onSaveClick()">
      Save
    </button>
  </sp-hbox>
  <sp-vbox [noGap]="true" [marginX]="true">
    <div class="w-full bg-primary-default h-10 rounded-t-md flex flex-row items-center justify-between pl-5 pr-5">
      <span class="float-left text-white font-medium">Model View</span>
      <div class="flex flex-row"><ng-content></ng-content></div>
    </div>
    <ngx-datatable class="material striped tableScroll" style="height: calc(100vh - 16rem);" [columnMode]="ColumnMode.flex"
      [headerHeight]="50" [footerHeight]="0" [rowHeight]="60" [rows]="treeStore.data" [scrollbarV]="true"
      [scrollbarH]="true" [treeFromRelation]="'parentId'" [treeToRelation]="'id'" (treeAction)="onTreeAction($event)">
      <!-- <ngx-datatable-column name="Id" [width]="80"></ngx-datatable-column> -->
      <ngx-datatable-column name="Display Name" prop="displayName" [canAutoResize]="true" [isTreeColumn]="true" [flexGrow]="3"
        [treeLevelIndent]="20">
        <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
          <span style="display: inline-flex" class="ml-5">
            <mat-icon>{{ row.icon }}</mat-icon>
            <span class="ml-2">
              {{ row.displayName }}</span>
            <!-- <span class="ml-2" *ngIf="row.level === 2"> {{ row.displayName }}</span> -->
          </span>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column name="Permission" prop="permission" [canAutoResize]="true" [flexGrow]="1">
        <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-row="row" let-value="value">
          <!-- <span (dblclick)="editing[rowIndex] = true" style="width: 300px;" *ngIf="!editing[rowIndex]">
              {{ value }}
            </span>   *ngIf="editing[rowIndex]"   (blur)="editing[rowIndex] = false"-->

          <mat-form-field appearance="outline" subscriptSizing="dynamic" class="w-min">
            <mat-select (selectionChange)="updateValue($event, rowIndex,row)" [value]="row.permission">
              <ng-container *ngFor="let item of getPermissions() ">
                <mat-option value="{{item}}" style="display: none;" *ngIf="(item === 'PARTIAL')"
                  disabled>{{getPermissionDisplayName(item)}}</mat-option>
                <mat-option value="{{item}}" *ngIf="item !== 'PARTIAL'">{{getPermissionDisplayName(item)}}</mat-option>
              </ng-container>
            </mat-select>
          </mat-form-field>
        </ng-template>
      </ngx-datatable-column>
    </ngx-datatable>
  </sp-vbox>
  <!-- </sp-hbox> -->
</sp-vbox>
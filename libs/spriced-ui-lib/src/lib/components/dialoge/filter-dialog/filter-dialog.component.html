
<div class="container">
  <div class="header">Filter</div>
  <div class="body">
    <query-builder
      [(ngModel)]="data.query"
      [config]="config"
      [allowCollapse]="true"
      [allowRuleset]="true"
      [disabled]="data.disabled || false"
      [persistValueOnFieldChange]="data.persistValueOnFieldChange || true"
      [emptyMessage]="data.emptyMessage || ''"
    >
      <ng-container
        *queryButtonGroup="
          let ruleset;
          let addRule = addRule;
          let addRuleSet = addRuleSet;
          let removeRuleSet = removeRuleSet
        "
      >
        <div class="flex flex-row">
          <button
            mat-raised-button
            *ngIf="addRuleSet"
            title="Rule"
            color="primary"
            (click)="addRule()"
            class="ml-2"
          >
            Rule
          </button>
          <button
            mat-raised-button
            *ngIf="addRuleSet"
            title="Rule set"
            color="primary"
            (click)="addRuleSet()"
            class="ml-2"
          >
            Rule set
          </button>
       
          <button
          *ngIf="removeRuleSet"
          (click)="removeRuleSet()"
          class="ml-2 h-full text-r-primary flex flex-row cursor-pointer p-2 border-r-primary-light border-solid"
        >
        <mat-icon class="mt-auto" >delete</mat-icon>
        </button>
        </div>
      </ng-container>

      <ng-container *queryArrowIcon>
        <mat-icon ngClass="mat-arrow-icon">chevron_right</mat-icon>
      </ng-container>

      <ng-container *queryRemoveButton="let rule; let removeRule = removeRule">
        <button
        (click)="removeRule(rule)"
        class="ml-2 h-full text-r-primary flex flex-row cursor-pointer p-2 border-r-primary-light border-solid"
      >
      <mat-icon class="mt-auto" >delete</mat-icon>
      </button>
      </ng-container>

      <ng-container *queryField="let rule; let fields=fields; let onChange=onChange">
        <mat-form-field class="ml-2" appearance="outline">
          <mat-select [(ngModel)]="rule.field" (ngModelChange)="onChange($event, rule)">
            <mat-option *ngFor="let field of fields" [value]="field.value">{{field.name}}</mat-option>
          </mat-select>
        </mat-form-field>
      </ng-container>

      <ng-container  *queryOperator="let rule; let operators=operators">
        <mat-form-field class="mx-4" appearance="outline">
          <mat-select [(ngModel)]="rule.operator">
            <mat-option *ngFor="let value of operators" [value]="value">{{value}}</mat-option>
          </mat-select>
        </mat-form-field>
      </ng-container>
          
      <!-- <ng-container *querySwitchGroup="let ruleset; let onChange = onChange">
        <mat-radio-group
          *ngIf="ruleset"
          [(ngModel)]="ruleset.condition"
          (ngModelChange)="onChange($event)"
        >
          <mat-radio-button [style.padding.px]="10" value="and"
            >And</mat-radio-button
          >
          <mat-radio-button [style.padding.px]="10" value="or"
            >Or</mat-radio-button
          >
        </mat-radio-group>
      </ng-container> -->
      <ng-container *querySwitchGroup="let ruleset; let onChange = onChange">
        <div *ngIf="ruleset" class="switch-container">
          <button
            mat-button
            class="square-button"
            [ngClass]="{ active: ruleset.condition === 'and' }"
            (click)="onChange('and')"
          >
            And
          </button>
          <button
            mat-button
            class="square-button"
            [ngClass]="{ active: ruleset.condition === 'or' }"
            (click)="onChange('or')"
          >
            Or
          </button>
        </div>
      </ng-container>
      
      
      <!-- <ng-container
        *queryInput="let rule; type: 'boolean'; let onChange = onChange"
      >
        <mat-checkbox
          [(ngModel)]="rule.value"
          (ngModelChange)="onChange()"
        ></mat-checkbox>
      </ng-container> -->
    </query-builder>
  </div>
  <div class="footer">
    <button mat-raised-button color="primary" (click)="onApply()" class="ml-2">
      Apply
    </button>
    <button mat-raised-button color="accent" (click)="onCancel()" class="ml-2">
      Cancel
    </button>
  </div>
</div>